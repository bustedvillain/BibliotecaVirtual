function BasicMP3Player(){var a=this,d=this,e=soundManager,b=(navigator.userAgent.match(/ipad|iphone/i)),c=(navigator.userAgent.match(/msie/i));this.excludeClass="button-exclude";this.links=[];this.sounds=[];this.soundsByURL={};this.indexByURL={};this.lastSound=null;this.soundCount=0;this.config={playNext:false,autoPlay:false};this.css={sDefault:"sm2_button",sLoading:"sm2_loading",sPlaying:"sm2_playing",sPaused:"sm2_paused"};this.includeClass=this.css.sDefault;this.addEventHandler=(typeof window.addEventListener!=="undefined"?function(h,g,f){return h.addEventListener(g,f,false)}:function(h,g,f){h.attachEvent("on"+g,f)});this.removeEventHandler=(typeof window.removeEventListener!=="undefined"?function(h,g,f){return h.removeEventListener(g,f,false)}:function(h,g,f){return h.detachEvent("on"+g,f)});this.classContains=function(g,f){return(typeof(g.className)!=="undefined"?g.className.match(new RegExp("(\\s|^)"+f+"(\\s|$)")):false)};this.addClass=function(g,f){if(!g||!f||a.classContains(g,f)){return false}g.className=(g.className?g.className+" ":"")+f};this.removeClass=function(g,f){if(!g||!f||!a.classContains(g,f)){return false}g.className=g.className.replace(new RegExp("( "+f+")|("+f+")","g"),"")};this.getSoundByURL=function(f){return(typeof a.soundsByURL[f]!=="undefined"?a.soundsByURL[f]:null)};this.isChildOfNode=function(g,f){if(!g||!g.parentNode){return false}f=f.toLowerCase();do{g=g.parentNode}while(g&&g.parentNode&&g.nodeName.toLowerCase()!==f);return(g.nodeName.toLowerCase()===f?g:null)};this.events={play:function(){d.removeClass(this._data.oLink,this._data.className);this._data.className=d.css.sPlaying;d.addClass(this._data.oLink,this._data.className)},stop:function(){d.removeClass(this._data.oLink,this._data.className);this._data.className=""},pause:function(){d.removeClass(this._data.oLink,this._data.className);this._data.className=d.css.sPaused;d.addClass(this._data.oLink,this._data.className)},resume:function(){d.removeClass(this._data.oLink,this._data.className);this._data.className=d.css.sPlaying;d.addClass(this._data.oLink,this._data.className)},finish:function(){d.removeClass(this._data.oLink,this._data.className);this._data.className="";if(d.config.playNext){var f=(d.indexByURL[this._data.oLink.href]+1);if(f<d.links.length){d.handleClick({target:d.links[f]})}}}};this.stopEvent=function(f){if(typeof f!=="undefined"&&typeof f.preventDefault!=="undefined"){f.preventDefault()}else{if(typeof window.event!=="undefined"){window.event.returnValue=false}}return false};this.getTheDamnLink=(c)?function(f){return(f&&f.target?f.target:window.event.srcElement)}:function(f){return f.target};this.handleClick=function(h){if(typeof h.button!=="undefined"&&h.button>1){return true}var j=a.getTheDamnLink(h),g,i,f;if(j.nodeName.toLowerCase()!=="a"){j=a.isChildOfNode(j,"a");if(!j){return true}}g=j.getAttribute("href");if(!j.href||!soundManager.canPlayLink(j)||a.classContains(j,a.excludeClass)){return true}if(!a.classContains(j,a.includeClass)){return true}e._writeDebug("handleClick()");i=(j.href);f=a.getSoundByURL(i);if(f){if(f===a.lastSound){f.togglePause()}else{f.togglePause();e._writeDebug("sound different than last sound: "+a.lastSound.id);if(a.lastSound){a.stopSound(a.lastSound)}}}else{f=e.createSound({id:"basicMP3Sound"+(a.soundCount++),url:i,onplay:a.events.play,onstop:a.events.stop,onpause:a.events.pause,onresume:a.events.resume,onfinish:a.events.finish,type:(j.type||null)});f._data={oLink:j,className:a.css.sPlaying};a.soundsByURL[i]=f;a.sounds.push(f);if(a.lastSound){a.stopSound(a.lastSound)}f.play()}a.lastSound=f;return a.stopEvent(h)};this.stopSound=function(f){soundManager.stop(f.id);if(!b){soundManager.unload(f.id)}};this.init=function(){e._writeDebug("basicMP3Player.init()");var g,f,k=0,h=document.getElementsByTagName("a");for(g=0,f=h.length;g<f;g++){if(a.classContains(h[g],a.css.sDefault)&&!a.classContains(h[g],a.excludeClass)){a.links[k]=(h[g]);a.indexByURL[h[g].href]=k;k++}}if(k>0){a.addEventHandler(document,"click",a.handleClick);if(a.config.autoPlay){a.handleClick({target:a.links[0],preventDefault:function(){}})}}e._writeDebug("basicMP3Player.init(): Found "+k+" relevant items.")};this.init()}var basicMP3Player=null;soundManager.preferFlash=false;soundManager.onready(function(){basicMP3Player=new BasicMP3Player()});