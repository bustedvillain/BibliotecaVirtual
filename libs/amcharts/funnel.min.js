AmCharts.AmFunnelChart=AmCharts.Class({inherits:AmCharts.AmSlicedChart,construct:function(a){this.type="funnel";AmCharts.AmFunnelChart.base.construct.call(this,a);this.cname="AmFunnelChart";this.startX=this.startY=0;this.baseWidth="100%";this.neckHeight=this.neckWidth=0;this.rotate=!1;this.valueRepresents="height";this.pullDistance=30;this.labelPosition="center";this.labelText="[[title]]: [[value]]";this.balloonText="[[title]]: [[value]]\n[[description]]";AmCharts.applyTheme(this,a,this.cname)},drawChart:function(){AmCharts.AmFunnelChart.base.drawChart.call(this);var af=this.chartData;if(AmCharts.ifArray(af)){if(0<this.realWidth&&0<this.realHeight){var ai=Math.round(this.depth3D*Math.cos(this.angle*Math.PI/180)),al=Math.round(-this.depth3D*Math.sin(this.angle*Math.PI/180)),ak=this.container,aa=this.startDuration,ah=this.rotate,P=this.updateWidth();this.realWidth=P;var ag=this.updateHeight();this.realHeight=ag;var ac=AmCharts.toCoordinate,T=ac(this.marginLeft,P),Z=ac(this.marginRight,P),aj=ac(this.marginTop,ag)+this.getTitleHeight(),ac=ac(this.marginBottom,ag);0<ai&&0>al&&(this.neckHeight=this.neckWidth=0,ah?ac-=al/2:aj-=al/2);var Z=P-T-Z,R=AmCharts.toCoordinate(this.baseWidth,Z),V=AmCharts.toCoordinate(this.neckWidth,Z),O=ag-ac-aj,j=AmCharts.toCoordinate(this.neckHeight,O),L=aj+O-j;ah&&(aj=ag-ac,L=aj-O+j);this.firstSliceY=aj;AmCharts.VML&&(this.startAlpha=1);for(var X=Z/2+T,S=(O-j)/((R-V)/2),N=1,i=R/2,R=(O-j)*(R+V)/2+V*j,K=aj,J=0,j=0;j<af.length;j++){var ae=af[j],ab;if(!0!==ae.hidden){var Y=[],Q=[],ad;if("height"==this.valueRepresents){ad=O*ae.percents/100}else{var U=-R*ae.percents/100/2,W=i;ab=-1/(2*S);ad=Math.pow(W,2)-4*ab*U;0>ad&&(ad=0);ad=(Math.sqrt(ad)-W)/(2*ab);if(!ah&&aj>=L||ah&&aj<=L){ad=2*-U/V}else{if(!ah&&aj+ad>L||ah&&aj-ad<L){ab=ah?Math.round(ad+(aj-ad-L)):Math.round(ad-(aj+ad-L)),ad=ab/S,ad=ab+2*(-U-(W-ad/2)*ab)/V}}}U=i-ad/S;W=!1;!ah&&aj+ad>L||ah&&aj-ad<L?(U=V/2,Y.push(X-i,X+i,X+U,X+U,X-U,X-U),ah?(ab=ad+(aj-ad-L),aj<L&&(ab=0),Q.push(aj,aj,aj-ab,aj-ad,aj-ad,aj-ab,aj)):(ab=ad-(aj+ad-L),aj>L&&(ab=0),Q.push(aj,aj,aj+ab,aj+ad,aj+ad,aj+ab,aj)),W=!0):(Y.push(X-i,X+i,X+U,X-U),ah?Q.push(aj,aj,aj-ad,aj-ad):Q.push(aj,aj,aj+ad,aj+ad));ak.set();ab=ak.set();0<ai&&0>al?(Y=U/i,Q=-1,ah||(Q=1),isNaN(N)&&(N=0),wedgeGraphics=(new AmCharts.Cuboid(ak,2*i,Q*ad,ai,al*N,ae.color,ae.alpha,this.outlineThickness,this.outlineColor,this.outlineAlpha,90,0,!1,0,ae.pattern,Y)).set,wedgeGraphics.translate(X-i,aj-al/2*N),N*=Y):wedgeGraphics=AmCharts.polygon(ak,Y,Q,ae.color,ae.alpha,this.outlineThickness,this.outlineColor,this.outlineAlpha);ab.push(wedgeGraphics);this.graphsSet.push(ab);ah||ab.toBack();ae.wedge=ab;ae.index=j;if(Y=this.gradientRatio){var Q=[],M;for(M=0;M<Y.length;M++){Q.push(AmCharts.adjustLuminosity(ae.color,Y[M]))}0<Q.length&&wedgeGraphics.gradient("linearGradient",Q);ae.pattern&&wedgeGraphics.pattern(ae.pattern)}0<aa&&(this.chartCreated||ab.setAttr("opacity",this.startAlpha));this.addEventListeners(ab,ae);ae.ty0=aj-ad/2;if(this.labelsEnabled&&this.labelText&&ae.percents>=this.hideLabelsPercent){Q=this.formatString(this.labelText,ae);(Y=this.labelFunction)&&(Q=Y(ae,Q));M=ae.labelColor;M||(M=this.color);var Y=this.labelPosition,o="left";"center"==Y&&(o="middle");"left"==Y&&(o="right");Q=AmCharts.wrappedText(ak,Q,M,this.fontFamily,this.fontSize,o,!1,this.maxLabelWidth);Q.node.style.pointerEvents="none";ab.push(Q);M=X;ah?(o=aj-ad/2,ae.ty0=o):(o=aj+ad/2,ae.ty0=o,o<K+J+5&&(o=K+J+5),o>ag-ac&&(o=ag-ac));"right"==Y&&(M=Z+10+T,ae.tx0=X+(i-ad/2/S),W&&(ae.tx0=X+U));"left"==Y&&(ae.tx0=X-(i-ad/2/S),W&&(ae.tx0=X-U),M=T);ae.label=Q;ae.labelX=M;ae.labelY=o;ae.labelHeight=Q.getBBox().height;Q.translate(M,o);i=Q.getBBox();K=AmCharts.rect(ak,i.width+5,i.height+5,"#ffffff",0.005);K.translate(M+i.x,o+i.y);ab.push(K);ae.hitRect=K;J=Q.getBBox().height;K=o}(0===ae.alpha||0<aa&&!this.chartCreated)&&ab.hide();aj=ah?aj-ad:aj+ad;i=U;ae.startX=AmCharts.toCoordinate(this.startX,P);ae.startY=AmCharts.toCoordinate(this.startY,ag);ae.pullX=AmCharts.toCoordinate(this.pullDistance,P);ae.pullY=0;ae.balloonX=X;ae.balloonY=ae.ty0}}this.arrangeLabels();this.initialStart();(af=this.legend)&&af.invalidateSize()}else{this.cleanChart()}}this.dispDUpd();this.chartCreated=!0},arrangeLabels:function(){var k=this.rotate,q;q=k?0:this.realHeight;for(var v=0,t=this.chartData,i=t.length,o,w=0;w<i;w++){o=t[i-w-1];var m=o.label,j=o.labelY,y=o.labelX,h=o.labelHeight,r=j;k?q+v+5>j&&(r=q+v+5):j+h+5>q&&(r=q-5-h);q=r;v=h;if(m){m.translate(y,r);var x=m.getBBox()}o.hitRect&&o.hitRect.translate(y+x.x,r+x.y);o.labelY=r;o.tx=y;o.ty=r;o.tx2=y}"center"!=this.labelPosition&&this.drawTicks()}});AmCharts.Cuboid=AmCharts.Class({construct:function(m,r,x,w,j,q,z,o,k,D,i,t,B,h,A,v){this.set=m.set();this.container=m;this.h=Math.round(x);this.w=Math.round(r);this.dx=w;this.dy=j;this.colors=q;this.alpha=z;this.bwidth=o;this.bcolor=k;this.balpha=D;this.dashLength=h;this.topRadius=v;this.pattern=A;(this.rotate=B)?0>r&&0===i&&(i=180):0>x&&270==i&&(i=90);this.gradientRotation=i;0===w&&0===j&&(this.cornerRadius=t);this.draw()},draw:function(){var an=this.set;an.clear();var aq=this.container,au=this.w,at=this.h,ai=this.dx,ap=this.dy,ac=this.colors,ao=this.alpha,ak=this.bwidth,ae=this.bcolor,ah=this.balpha,ar=this.gradientRotation,S=this.cornerRadius,U=this.dashLength,R=this.pattern,Y=this.topRadius,aa=ac,ag=ac;"object"==typeof ac&&(aa=ac[0],ag=ac[ac.length-1]);var T,Q,X,P,O,am,aj,W,ad,al=ao;R&&(ao=0);var af,V,ab,Z,N=this.rotate;if(0<Math.abs(ai)||0<Math.abs(ap)){if(isNaN(Y)){aj=ag,ag=AmCharts.adjustLuminosity(aa,-0.2),ag=AmCharts.adjustLuminosity(aa,-0.2),T=AmCharts.polygon(aq,[0,ai,au+ai,au,0],[0,ap,ap,0,0],ag,ao,1,ae,0,ar),0<ah&&(ad=AmCharts.line(aq,[0,ai,au+ai],[0,ap,ap],ae,ah,ak,U)),Q=AmCharts.polygon(aq,[0,0,au,au,0],[0,at,at,0,0],ag,ao,1,ae,0,ar),Q.translate(ai,ap),0<ah&&(X=AmCharts.line(aq,[ai,ai],[ap,ap+at],ae,ah,ak,U)),P=AmCharts.polygon(aq,[0,0,ai,ai,0],[0,at,at+ap,ap,0],ag,ao,1,ae,0,ar),O=AmCharts.polygon(aq,[au,au,au+ai,au+ai,au],[0,at,at+ap,ap,0],ag,ao,1,ae,0,ar),0<ah&&(am=AmCharts.line(aq,[au,au+ai,au+ai,au],[0,ap,at+ap,at],ae,ah,ak,U)),ag=AmCharts.adjustLuminosity(aj,0.2),aj=AmCharts.polygon(aq,[0,ai,au+ai,au,0],[at,at+ap,at+ap,at,at],ag,ao,1,ae,0,ar),0<ah&&(W=AmCharts.line(aq,[0,ai,au+ai],[at,at+ap,at+ap],ae,ah,ak,U))}else{var o,j,i;N?(o=at/2,ag=ai/2,i=at/2,j=au+ai/2,V=Math.abs(at/2),af=Math.abs(ai/2)):(ag=au/2,o=ap/2,j=au/2,i=at+ap/2+1,af=Math.abs(au/2),V=Math.abs(ap/2));ab=af*Y;Z=V*Y;0.1<af&&0.1<af&&(T=AmCharts.circle(aq,af,aa,ao,ak,ae,ah,!1,V),T.translate(ag,o));0.1<ab&&0.1<ab&&(aj=AmCharts.circle(aq,ab,AmCharts.adjustLuminosity(aa,0.5),ao,ak,ae,ah,!1,Z),aj.translate(j,i))}}ao=al;1>Math.abs(at)&&(at=0);1>Math.abs(au)&&(au=0);!isNaN(Y)&&(0<Math.abs(ai)||0<Math.abs(ap))?(ac=[aa],ac={fill:ac,stroke:ae,"stroke-width":ak,"stroke-opacity":ah,"fill-opacity":ao},N?(ao="M0,0 L"+au+","+(at/2-at/2*Y),ak=" B",0<au&&(ak=" A"),AmCharts.VML?(ao+=ak+Math.round(au-ab)+","+Math.round(at/2-Z)+","+Math.round(au+ab)+","+Math.round(at/2+Z)+","+au+",0,"+au+","+at,ao=ao+(" L0,"+at)+(ak+Math.round(-af)+","+Math.round(at/2-V)+","+Math.round(af)+","+Math.round(at/2+V)+",0,"+at+",0,0")):(ao+="A"+ab+","+Z+",0,0,0,"+au+","+(at-at/2*(1-Y))+"L0,"+at,ao+="A"+af+","+V+",0,0,1,0,0"),af=90):(ak=au/2-au/2*Y,ao="M0,0 L"+ak+","+at,AmCharts.VML?(ao="M0,0 L"+ak+","+at,ak=" B",0>at&&(ak=" A"),ao+=ak+Math.round(au/2-ab)+","+Math.round(at-Z)+","+Math.round(au/2+ab)+","+Math.round(at+Z)+",0,"+at+","+au+","+at,ao+=" L"+au+",0",ao+=ak+Math.round(au/2+af)+","+Math.round(V)+","+Math.round(au/2-af)+","+Math.round(-V)+","+au+",0,0,0"):(ao+="A"+ab+","+Z+",0,0,0,"+(au-au/2*(1-Y))+","+at+"L"+au+",0",ao+="A"+af+","+V+",0,0,1,0,0"),af=180),aq=aq.path(ao).attr(ac),aq.gradient("linearGradient",[aa,AmCharts.adjustLuminosity(aa,-0.3),AmCharts.adjustLuminosity(aa,-0.3),aa],af),N?aq.translate(ai/2,0):aq.translate(0,ap/2)):aq=0===at?AmCharts.line(aq,[0,au],[0,0],ae,ah,ak,U):0===au?AmCharts.line(aq,[0,0],[0,at],ae,ah,ak,U):0<S?AmCharts.rect(aq,au,at,ac,ao,ak,ae,ah,S,ar,U):AmCharts.polygon(aq,[0,0,au,au,0],[0,at,at,0,0],ac,ao,ak,ae,ah,ar,!1,U);au=isNaN(Y)?0>at?[T,ad,Q,X,P,O,am,aj,W,aq]:[aj,W,Q,X,P,O,T,ad,am,aq]:N?0<au?[T,aq,aj]:[aj,aq,T]:0>at?[T,aq,aj]:[aj,aq,T];for(at=0;at<au.length;at++){(ai=au[at])&&an.push(ai)}R&&aq.pattern(R)},width:function(a){this.w=Math.round(a);this.draw()},height:function(a){this.h=Math.round(a);this.draw()},animateHeight:function(c,e){var b=this;b.easing=e;b.totalFrames=Math.round(1000*c/AmCharts.updateRate);b.rh=b.h;b.frame=0;b.height(1);setTimeout(function(){b.updateHeight.call(b)},AmCharts.updateRate)},updateHeight:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b&&(b=a.easing(0,a.frame,1,a.rh-1,b),a.height(b),setTimeout(function(){a.updateHeight.call(a)},AmCharts.updateRate))},animateWidth:function(c,e){var b=this;b.easing=e;b.totalFrames=Math.round(1000*c/AmCharts.updateRate);b.rw=b.w;b.frame=0;b.width(1);setTimeout(function(){b.updateWidth.call(b)},AmCharts.updateRate)},updateWidth:function(){var a=this;a.frame++;var b=a.totalFrames;a.frame<=b&&(b=a.easing(0,a.frame,1,a.rw-1,b),a.width(b),setTimeout(function(){a.updateWidth.call(a)},AmCharts.updateRate))}});